%%  A report on laboratory work 2.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[12pt,a4paper]{article}

%%  Стандартные языковые команды
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}

%%  Подключение стилевого файла отчета
\usepackage{kprj}

%%   Подключение пакета управления гиперссылками (только для pdftex)
\ifpdftex
   \usepackage[unicode=true]{hyperref}
   \hypersetup{pdfpagemode=UseNone, pdfstartview = FitR 0 0 200 1000}
   \BlackColorLinks
\fi

%%%  Для подключения рисунков (разные форматы при разном компилировании)
\ifpdftex
  \DeclareGraphicsExtensions{.pdf}
\else
  \DeclareGraphicsExtensions{.eps}
\fi


\LabWork                      %   тип документа -- лабораторная работа
\LabWorkNo{4}                 %   номер лабораторной работы
\variant{4}                   %   вариант лабораторной


%%%  Данные для оформления

\author{Д.Д.~Девяткин}                     %   автор
\workyear{2020}                         %   год выполнения работы
\title{Циклы}   %  название
\discipline{Качественная теория ОДУ}              %  учебная дисциплина
\group{ФН12-71}                          %   группа
\faculty{Фундаментальные науки}         %   Факультет
\chair{Математическое моделирование}    %   кафедра
\chief{А.Н.~Канатников}                     %   Руководитель работы

\equationnumbering{section}             %   если нумерация формул в пределах раздела (иначе единая нумерация)
%\figurenumbering{section}              %   (аналогично для рисунков)

\begin{document}

%%%   Формирование титульного листа
\maketitle
%  Для формирования содержания
\tableofcontents
	

\section-{Постановка задачи}
Для заданной системы 2-го порядка:\\
a) проанализировать фазовый портрет и выделить область существования цикла;\\
б) задав трансверсальную кривую, найти точку на цикле и построить цикл численно;\\
в) определить период у цикла; \\
г) вычислить мультипликаторы цикла.


\section{Исходные данные}

\begin{equation*}
 \begin{cases}
\dot{x} = -x^2 + \dfrac{17}{9}xy -\dfrac{9}{10}y^2 + \dfrac{40}{9}x-\dfrac{19}{3}y + \dfrac{8}{15};\\
\dot{y} =  -x^2 + \dfrac{7}{4}xy - y^2 + 4x - \dfrac{9}{2}y + \dfrac{3}{2}.
 \end{cases}
\end{equation*}

\section{Реализация}

\subsection{Область цикла}
Для понимания существует ли вообще цикл в системе, необходимо построить отображение Пуанкаре. Эта кривая должна пересекать ось $x$. Для его построение производится интегрирование системы в точке, до того момента, пока разность после интегрирования между начальной точкой кривой и конечной не будет меньше некоторого $\varepsilon$. Идем по лучу, который направлен в $+\infty$, идём с шагом $h$ --- это координата $x$ в начальных условиях интегрирования. В качестве начальных условий коордиты $y$ берем координату $y$ положения равновесия. Координаты отображения Пуанкаре --- это 2 массива: $X, Y$. Массив $X$ представляет собой точки на луче, массив $Y$ --- это разность последней и первой координаты кривой после $i$-го интегрирования.
На рис. 1 представлен фазовый портрет системы. По этому портрету видно, что цикл находится в области $ [-5, \,\, 5 ][4\,\,3] $.
\begin{figure}[h!]
 \centerline{\includegraphics[scale=0.6]{Puankare_pic.png}}
 \vskip2mm
 \caption{Отображение Пуанкаре.}\label{fig1}
\end{figure} 

\subsection{Численное построение цикла}
Для численного пострения цикла используем похожий подход. Начинаем идти по лучу оси $x$ с шагом $h$ и брать эту точку в качестве начальной координаты $x$, начальная координата $y$ --- координата $y$ положениe равновесия. Продолжаем интегрирование до тех пор пока разность между начальной и конечной точкой кривой не будет меньше $\varepsilon$. Интегрирование производит по следющей схеме: интугрирование идет до тех пор, пока не будет пройдено $2\pi$, то есть пока не будет перехода из 4 четверти в 1-ую. Для этого задаем настройки интегрирования с помощью $opts$ и функции $stopInt$, где указываем параметр $\textbf{isterminal}$ равной 1. Это значит, что будем станавливать расчёт при условии, если пересекаем ось $x$ снизу вверх. Также вводим парметр $\delta$ для того чтобы не было остановки интегрирования на 1-2 шаге, в случае близости к положению равновесия.


\subsection{Период} 
При интегрировании с помощью функции $ode45$ получаем массив координат и массив $t$ точек времени за один оборот. Для получения периода из последнего значения массива $t$ вычитаем первое. Период равен  3.3383.

\begin{figure}[h!]
 \centerline{\includegraphics[scale=0.75]{Phase.png}}
 \vskip2mm
 \caption{Фазовый портрет системы и цикл.}\label{fig1}
\end{figure} 

\subsection{Мультипликаторы цикла} 
Матрицу $C = e^{RT}$ для нормаированной матрицы $\Phi_0(t)$ называют $\textbf{матрице монодромии}$, где $\Phi_0(t)$ фундаментальная матрица : $\Phi_0(0) = 0$. $\Phi_0(T)=Z_0(T)e^{RT}=e^{RT}$, где $Z(t)$ --- T-периодическая невырожденная матрица, R --- постоянная матрица. Матрица монодромии представляем собой нормаированную матрицу, вычисленную через период: $C=\Phi_0(T)$. Собственные числа матрицы $R$ называются $\textbf{характеристическими показателями}$, а собственные числа матрицы монодромии $\textbf{характеристическими множителями}$ или $\textbf{мультипликаторами}$. При поиске мультипликаторов в качестве начальной матрицы берем единичную. Считаем полусумму матриц линейного приближения в моменты времени $t_{i+1}$ и $t_i$, обозначим эту матрицу $A$, дальше вовзодим матричную экспоненту в степень $A (t_{i+1} - t_i)$. Проходим по всему массиву времени, который был найден при интегрировании. В итоге получаем матрицу, находим её собственные числа --- это и есть мальтипликаторы. В нашем случае это 0.2528 и 0.9999.

\end{document}
