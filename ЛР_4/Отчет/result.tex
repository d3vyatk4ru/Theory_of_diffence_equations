	%%  A report on laboratory work 2.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[12pt,a4paper]{article}

%%  Стандартные языковые команды
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}

%%  Подключение стилевого файла отчета
\usepackage{kprj}

%%   Подключение пакета управления гиперссылками (только для pdftex)
\ifpdftex
   \usepackage[unicode=true]{hyperref}
   \hypersetup{pdfpagemode=UseNone, pdfstartview = FitR 0 0 200 1000}
   \BlackColorLinks
\fi

%%%  Для подключения рисунков (разные форматы при разном компилировании)
\ifpdftex
  \DeclareGraphicsExtensions{.pdf}
\else
  \DeclareGraphicsExtensions{.eps}
\fi


\LabWork                      %   тип документа -- лабораторная работа
\LabWorkNo{4}                 %   номер лабораторной работы
\variant{4}                   %   вариант лабораторной


%%%  Данные для оформления

\author{Д.Д.~Девяткин}                     %   автор
\workyear{2020}                         %   год выполнения работы
\title{Циклы}   %  название
\discipline{Качественная теория ОДУ}              %  учебная дисциплина
\group{ФН12-71}                          %   группа
\faculty{Фундаментальные науки}         %   Факультет
\chair{Математическое моделирование}    %   кафедра
\chief{А.Н.~Канатников}                     %   Руководитель работы

\equationnumbering{section}             %   если нумерация формул в пределах раздела (иначе единая нумерация)
%\figurenumbering{section}              %   (аналогично для рисунков)

\begin{document}

%%%   Формирование титульного листа
\maketitle
%  Для формирования содержания
\tableofcontents
	

\section-{Постановка задачи}
Для заданной системы 2-го порядка:\\
a) проанализировать фазовый портрет и выделить область существования цикла;\\
б) задав трансверсальную кривую, найти точку на цикле и построить цикл численно;\\
в) определить период у цикла; \\
г) вычислить мультипликаторы цикла.


\section{Исходные данные}

\begin{equation*}
 \begin{cases}
\dot{x} = -x^2 + \dfrac{17}{9}xy -\dfrac{9}{10}y^2 + \dfrac{40}{9}x-\dfrac{19}{3}y + \dfrac{8}{15};\\
\dot{y} =  -x^2 + \dfrac{7}{4}xy - y^2 + 4x - \dfrac{9}{2}y + \dfrac{3}{2}.
 \end{cases}
\end{equation*}

\section{Реализация}

\subsection{Область цикла}
Найдем положения равновесия (ПР) системы. Сделаем это с помощью функции $solve$. Получаем 2 ПР: 
\begin{center}
$P_1(-1.0844, -0.7051)$, \,\,\,\,\,
$P_2(5.0869, 1.2981).$
\end{center}
Построим фазовый портрет системы вблизи ПР $P_1$ и $P_2$.
\begin{figure}[h!]
 \centerline{\includegraphics[scale=0.67]{Phase_all_points.png}}
 \vskip2mm
 \caption{Фазовый портрет системы вблизи ПР.}\label{fig1}
\end{figure} 
\newpage
Найдем собственные значения каждого ПР: $\lambda_{1, 1} =0.1470 - 2.9558i, \lambda_{1,2}=   0.1470 + 2.9558i$, $\lambda_{2, 1} =-2.4082, \lambda_{1,2}= 0.9367$. Получаем, что $P_1$ --- неустойчивый фокус, $P_2$ --- седло.
 Получаем, что цикл сущесвует/проходит вокруг положения равновесия $P_1$, это видно по фазовому портрету на рис. 1.\\

Чтобы показать, что цикл существует построим \textbf{отображение Пуанкаре}. Зададим трансверсальную кривую. В качестве кривой будем брать прямую, параллельную оси $Ox$, которая начинается в положении равновесия $P_1$. В качестве начального положения возьмем точку, лежащую на заданном луче, которая расположена на малом расстоянии от положения равновесия, то есть точку $P_1 + \varepsilon$. Точка с координатой $X$ через
оборот переходит в точку с координатой $y$. Функция $y(X)$ --- отображение Пуанкаре, записанное в координатах. Построим функцию $y(X)$ - $X$ для каждой начальной точки на луче, ее нули будут соответствовать циклам. Реализация следующая: будем двигаться  по оси $Ox$ с шагом $h$ = 0.01. Начинаем интегрировать по времени с начальными условиями $X_0 = P_1 + \varepsilon$. Интегрирование осуществляется с помощью функции $ode45$. Продолжать интегрирование будем до тех пор, пока кривая не совершит полный оборот, то есть пока не пройдет полную спираль и не перессечет ось $Ox$ снизу вверх. Поскольку $Re \lambda_{1,1} > 0$, $Re \lambda_{1,2} > 0$, ПР будет неустойчивым. Поэтому нтегрирование будем производить на отрезке $[0, t]$. Останавливать интегрирование будем в тот момент, когда полученная траектория $\gamma(t)$ совершит полный оборот,  с помощью «Events». При этом конечная точка $y(X)$ будет смещена относительно начальной точки $X$ на $y(X) - X$. Если полученное значение $\gamma(t)$  будет равно начальному положению с определенной точностью $\varepsilon$, то отнимем от исходного начального положения шаг, с которым мы двигаемся по лучу, при построении цикла будем интегрировать именно из этой точки, обозначим его $cond$, так как оно понадобится для описания численного построения цикла. После чего, берем точку на луче, находящуюся на расстоянии $h$ от предыдущего начального положения, то есть $X_1 = X_0 + h$. И проделываем то же самое. В результате имеем, что график зависимости $(y(X) - X)(X)$ --- это график отображения Пуанкаре. На рис. 2 представлено отображение Пуанкаре. Видно, что этот график пересекает ось $Ox$, то есть имеет ноль, значит вблизи этой точки есть цикл. Эта точка имеет координаты (2.6, 0).

\subsection{Численное построение цикла}
Поскольку цикл является \textbf{устойчивым}, то можно поступить следующим образом :для численного пострения будем использовать подход, схожий с построением отображения Пуанкаре. Возьмем точку правее положения равновесия $P_1$ на 0.1 по оси $Ox$, по $Oy$ значение оставим то же, обозначим эту точку $X_0$. Этого условия достаточно для построения цикла. После того, как взяли точку, будем искать цикл, путем интегрирования исходной системы. Останавливать интегрирование будем, когда траектория пересечет ось $Ox$ снизу вверх, то есть пройдет одну полную спираль. В итоге получим некоторую точку $X_1$, которая лежит правее $X_0$, т.е. $X_1 = X_0 + dX_1,$ где $dX_1 = (dx_1, 0)$. Если значение $dx_1 < \varepsilon$ ($\varepsilon$ задано заранее), то интегрирование можно прекращать, в противном же случае начинаем интегрировать с точки $X_1$. В результате интегрирования получим $X_2 : X_2 = X_1+ dX_2,$ где $dX_2 = (dx_2, 0)$. Опять сравниваем с $\varepsilon$ и повторяем процедуру, если необходимо. В итоге на шаге $n$ получим, что $dx_n < \varepsilon$, это будет означать, что $X_{n-1}\thickapprox X_n$ и можно останавливать итерационный процесс. Получаем приближенно замкнутую кривую, это есть цикл (см. рис. 3).
 \begin{figure}[h!]
 \centerline{\includegraphics[scale=0.6]{Puankare_pic.png}}
 \vskip2mm
 \caption{Отображение Пуанкаре.}\label{fig1}
\end{figure}
\begin{figure}[h!]
 \centerline{\includegraphics[scale=0.67]{Phase.png}}
 \vskip2mm
 \caption{Цикл и фазовый портрет вблизи $P_1$.}\label{fig1}
\end{figure} 

\subsection{Период} 
 \textbf{Период} это время совершения одного оборота, время одной спирали. Период $T $ = 3.3383.	

\subsection{Мультипликаторы цикла} 
Пусть есть линейная система $\dot{x} = A(t)x$ с $T$-периодической матрицей $A(t)$, тогда по теореме \textbf{Флоке} любая фундаментальная матрица для линейной истемы системы может быть представлена в виде
\begin{center}
$\Phi(t) = Z(t)e^{Rt}$ ,
\end{center}
где $Z(t)$ --- $T$-периодическая невырожденная матрица, а $R$ --- постоянная матрица. 
Матрицу $C = e^{Rt}$ для нормированной матрицы $\Phi_0(t)$ называют \textbf{матрицей монодромии}. Здесь  $\Phi_0(t) :  \Phi_0(0) = E$.
\textbf{Мультипликаторами цикла} называют собственные значения матрицы монодромии.\\
В задаче присутствует цикл $\gamma$, в каждой его точке можно составить линеаризованную систему $\dot{\xi} = A(t)\xi$, где $f'(\gamma(t))=A(t)$ --- матрица Якоби в точке $\gamma(t)$, так цикл изместен только на дискретном времени $t_i$. Матрица $A(t)$ является периодической и такая, что $A(t) = A(t + T)$, где $T$ --- период цикла. Точки кривой $\gamma(t)$ будем брать с малым шагом, чтобы матрица $A(t)$ была почти постоянной на отрезке $ [t_i,\,\,t_{i+1}]$. Решение системы на интервале $ (t_i,\,\,t_{i+1}) $ будет выглядеть следюущим образом
\begin{center}
$\xi(t)$ = exp$\{A_i(t - t_i)\}\xi(t_i)$
\end{center}
Подставляя $t = t_{i+1}$ 
\begin{center}
$\xi(t)$ = exp$\{A_i(t_{i+1} - t_i)\}\xi(t_i)$
\end{center}
Можно увидеть рекурентность и рекурентность и выразить все через формулу
\begin{center}
$\xi(t)$ = exp$\{A_{n-1}(t_n - t_{n-1})\} \cdot$ exp$\{A_{n-2}(t_{n-1} - t_{n-2})\}\cdot\ldots \cdot$ exp$\{A_{1}(t_{2} - t_{2})\}\xi(0)$.\end{center}
Матрицу монодромии можно вычислить следующим образом
\begin{center}
$e^{RT}$ = exp$\{A_{n-1}(t_n - t_{n-1})\} \cdot$ exp$\{A_{n-2}(t_{n-1} - t_{n-2})\}\cdot\ldots \cdot$ exp$\{A_{1}(t_{2} - t_{2})\}$,
\end{center}
где $A_i$ – матрица якоби исходной системы в точке $\gamma(t)$,$t \in [t_i, t_{i+1}]$
Получем следующие мультипликаторы
\begin{center}
$\rho_1 = 0.2528$, \,\,\,\, $\rho_1 \approx 1$.
\end{center}
Проанализируем мультипликаторы. Имеем, что $|\rho_1| < 1$ и $\rho_1 \approx 1$. Это значит, что система и цикл устойчивы. 
\end{document}
