%%  A report on laboratory work 2.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[12pt,a4paper]{article}

%%  Стандартные языковые команды
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}

%%  Подключение стилевого файла отчета
\usepackage{kprj}

%%   Подключение пакета управления гиперссылками (только для pdftex)
\ifpdftex
   \usepackage[unicode=true]{hyperref}
   \hypersetup{pdfpagemode=UseNone, pdfstartview = FitR 0 0 200 1000}
   \BlackColorLinks
\fi

%%%  Для подключения рисунков (разные форматы при разном компилировании)
\ifpdftex
  \DeclareGraphicsExtensions{.pdf}
\else
  \DeclareGraphicsExtensions{.eps}
\fi


\LabWork                      %   тип документа -- лабораторная работа
\LabWorkNo{4}                 %   номер лабораторной работы
\variant{4}                   %   вариант лабораторной


%%%  Данные для оформления

\author{Д.Д.~Девяткин}                     %   автор
\workyear{2020}                         %   год выполнения работы
\title{Циклы}   %  название
\discipline{Качественная теория ОДУ}              %  учебная дисциплина
\group{ФН12-71}                          %   группа
\faculty{Фундаментальные науки}         %   Факультет
\chair{Математическое моделирование}    %   кафедра
\chief{А.Н.~Канатников}                     %   Руководитель работы

\equationnumbering{section}             %   если нумерация формул в пределах раздела (иначе единая нумерация)
%\figurenumbering{section}              %   (аналогично для рисунков)

\begin{document}

%%%   Формирование титульного листа
\maketitle
%  Для формирования содержания
\tableofcontents
	

\section-{Постановка задачи}
Для заданной системы 2-го порядка:\\
a) проанализировать фазовый портрет и выделить область существования цикла;\\
б) задав трансверсальную кривую, найти точку на цикле и построить цикл численно;\\
в) определить период у цикла; \\
г) вычислить мультипликаторы цикла.


\section{Исходные данные}

\begin{equation*}
 \begin{cases}
\dot{x} = -x^2 + \dfrac{17}{9}xy -\dfrac{9}{10}y^2 + \dfrac{40}{9}x-\dfrac{19}{3}y + \dfrac{8}{15};\\
\dot{y} =  -x^2 + \dfrac{7}{4}xy - y^2 + 4x - \dfrac{9}{2}y + \dfrac{3}{2}.
 \end{cases}
\end{equation*}

\section{Реализация}

\subsection{Область цикла}
Найдем положения равновесия (ПР) системы. Сделаем это с помощью функции $solve$. Получаем 2 ПР: 
\begin{center}
$P_1(-1.0844, -0.7051)$, \,\,\,\,\,
$P_2(5.0869, 1.2981).$
\end{center}
Построим фазовый портрет системы вблизи ПР $P_1$ и $P_2$.
\begin{figure}[h!]
 \centerline{\includegraphics[scale=0.67]{Phase_all_points.png}}
 \vskip2mm
 \caption{Фазовый портрет системы вблизи ПР.}\label{fig1}
\end{figure} 
\newpage
 Получаем, что цикл сущесвует/проходит вокруг положения равновесия $P_1$, это видно по фазовому портрету на рис. 1.\\

Чтобы показать, что цикл существует построим \textbf{отображение Пуанкаре} . В качестве трансверсальной кривой будем брать прямую, параллельную оси $Ox$, которая проходит через координату $y$ ПР $P_1$. Начнем поиск с точки $P_1 + \varepsilon$. Далее будем прибавлять шаг $h$ = 0.01, двигаясь по оси $Ox$. Начинаем интегрировать по времени с начальными условиями $X_0 = P_1 + \varepsilon$. Продолжать интегрирование будем до тех пор, пока кривая не совершит полный оборот, то есть пока не пройдет полную спираль и не перессечет ось $Ox$ снизу вверх. При этом конечная точка $f(X)$ будет смещена относительно начальной точки $X$ на $f(X) - X$. Следующая итерация интегрирования начинается с точки $X_1 = X_0 + h$. Интегрирование происходит также до одного оборота (одной спирали), в результате повторяем данную операцию до тех пор, пока не определим прошла ли начальная точка область, в которой может быть цикл. Интегрирование осуществляется с помошью функции $ode45$. В результате имеем, что график зависимости $(f(X) - X)(X)$ --- это график отображения Пуанкаре. На рис. 2 представлено отображение Пуанкаре. Видно, что этот график пересекает ось $Ox$, то есть имеет ноль, значит вблизи этой точки есть цикл. Эта точка имеет координаты (1.28, 0).
 \begin{figure}[h!]
 \centerline{\includegraphics[scale=0.6]{Puankare_pic.png}}
 \vskip2mm
 \caption{Отображение Пуанкаре.}\label{fig1}
\end{figure}

\subsection{Численное построение цикла}
Для численного пострения цикла используем похожий подход. Интегрируем аналогично пострению отображения Пуанкаре. Начинаем с точки $X_0=P_1+h$. На следующей итерации в качестве начальной точки имеем $X_1 = X_0 + dX_1$, где $dX_1$ по координате $y$ равна 0. Дальше в качестве начальной точки берем $X_1$ и получаем $X_2 = X_1 + dX_2$, где вторая координата у $dX_2$ также равна 0. Интегрирование заканчиваем тогда, когда $X_k - X_{k-1} < \varepsilon$, где $\varepsilon$ задано заранее. Эта разность будет по оси $Ox$, так как вторая координата равна 0. В итоге получаем примерно замкнутую кривую. Это можно увидеть на рис. 3.
\begin{figure}[h!]
 \centerline{\includegraphics[scale=0.67]{Phase.png}}
 \vskip2mm
 \caption{Цикл и фазовый портрет вблизи $P_1$.}\label{fig1}
\end{figure} 

\subsection{Период} 
\textbf{Период} $T $ = 3.3383. \textbf{Период} это время совершения одного оборота, время одной спирали.	

\subsection{Мультипликаторы цикла} 
В задаче присутствует цикл $\gamma$, в каждой его точке можно составить линеаризованную систему $\dot{\xi} = A(t)\xi$, где $f'(\gamma(t))=A(t)$ --- матрица Якоби в точке $\gamma(t)$, так цикл изместен только на дискретном времени $t_i$. Матрица $A(t)$ является периодической и такая, что $A(t) = A(t + T)$, где $T$ --- период цикла. Точки кривой $\gamma(t)$ будем брать с малым шагом, чтобы матрица $A(t)$ была почти постоянной на отрезке $ [t_i,\,\,t_{i+1}] $, то есть  $\dot{\xi} = A_i\xi$, где $A_i =\dfrac{ A(x_i,y_i) + A(x_{i+1}, y_{i+1})}{2}$. Решение системы на интервале $ (t_i,\,\,t_{i+1}) $ будет иметь следующий вид
\begin{center}
$\xi(t)$ = exp$\{A_i(t - t_i)\}\xi(t_i)$
\end{center}
Подставляя все промежутки времени и используя реккурентность, получим следующее решение 
\begin{center}
$\xi(t)$ = exp$\{A_{n-1}(t_n - t_{n-1})\} \cdot$ exp$\{A_{n-2}(t_{n-1} - t_{n-2})\}\cdot\ldots \cdot$ exp$\{A_{1}(t_{2} - t_{2})\}\xi(0)$.\end{center}

\textbf{Матрица монодромии $e^{RT}$} --- это нормированная фундаментальная матрица. В данном случае
\begin{center}
$e^{RT}$ = exp$\{A_{n-1}(t_n - t_{n-1})\} \cdot$ exp$\{A_{n-2}(t_{n-1} - t_{n-2})\}\cdot\ldots \cdot$ exp$\{A_{1}(t_{2} - t_{2})\}$.
\end{center}

\textbf{Мультипликаторами цикла} называют собственные значения матрицы монодромии. В данном случае мультипликаторы имеют вид
\begin{center}
$\rho_1 = 0.2528$, \,\,\,\, $\rho_1 \approx 1$.
\end{center}
Проанализируем мультипликаторы. Имеем, что $|\rho_1| < 1$ и $\rho_1 \approx 1$. Это значит, что система и цикл устойчивы. 
\end{document}
