%%  A report on laboratory work 2.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[12pt,a4paper]{article}

%%  Стандартные языковые команды
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}
\usepackage{amssymb, amsmath}

%%  Подключение стилевого файла отчета
\usepackage{kprj}

%%   Подключение пакета управления гиперссылками (только для pdftex)
\ifpdftex
   \usepackage[unicode=true]{hyperref}
   \hypersetup{pdfpagemode=UseNone, pdfstartview = FitR 0 0 200 1000}
   \BlackColorLinks
\fi

%%%  Для подключения рисунков (разные форматы при разном компилировании)
\ifpdftex
  \DeclareGraphicsExtensions{.pdf}
\else
  \DeclareGraphicsExtensions{.eps}
\fi


\LabWork                      %   тип документа -- лабораторная работа
\LabWorkNo{3}                 %   номер лабораторной работы
\variant{4}                   %   вариант лабораторной


%%%  Данные для оформления

\author{Д.Д.~Девяткин}                     %   автор
\workyear{2020}                         %   год выполнения работы
\title{Вырожденные системы}   %  название
\discipline{Качественная теория ОДУ}              %  учебная дисциплина
\group{ФН12-71}                          %   группа
\faculty{Фундаментальные науки}         %   Факультет
\chair{Математическое моделирование}    %   кафедра
\chief{А.Н.~Канатников}                     %   Руководитель работы

\equationnumbering{section}             %   если нумерация формул в пределах раздела (иначе единая нумерация)
%\figurenumbering{section}              %   (аналогично для рисунков)

\begin{document}

%%%   Формирование титульного листа
\maketitle
%  Для формирования содержания
\tableofcontents
	

\section-{Постановка задачи}
Для заданной системы 2-го порядка, имеющей нулевое положение равновесия:\\
a) найти линейное приближение в нуле и записать характеристические числа;\\
б) построить нормальную форму 2-го порядка;\\
в) построить фазовый портрет системы в окрестности нулевого положения равновесия.


\section{Исходные данные}

\begin{equation*}
 \begin{cases}
\dot{x} = (1+x)(1-y)-cos(x-y);\\
\dot{y} = e^{x-y} - cos(x+y).
 \end{cases}
  \eqno(1)
\end{equation*}

\section{Реализация}

\subsection{Линейное приближение}
Поскольку по условию дано положение равновесия --- $(0,\, 0)$, то подробно описывать их поиск не будем. Скажем лишь то, что для их поиска надо приравнять правые части системы (1) к нулю и найти её решения. По итогу имеем 1 точку покоя: $P_1(0,\,0)$.


Для записи линейного приближения в нуле находим матрицу Якоби системы и рассматриваем её в точке $P_1$. Якобиан находим с помощью MATLAB-функции $jacobian$. Матрица Якоби имеет вид
$$ J = 
\begin{pmatrix}
sin(x - y) - y + 1 & -x - sin(x - y) - 1 \\
e^{(x - y)} + sin(x + y) & sin(x + y) - e^{(x - y)} \\
\end{pmatrix}
$$
Первое приближение в нуле имеет следующий вид
\begin{equation*}
 \begin{cases}
\dot{x} = x-y;\\
\dot{y} = x-y.
 \end{cases}
\end{equation*}
C помощью функции $eig$ находим собственные числа. Получаются следующие собственные значения: $\lambda_1$ = 0, $\lambda_2$ = 0.  Поскольку имеем хотя бы одно нулевое собсвенное значени, то точка не является гиперболической и по линейному приближению нельзя сделать никаких оценок о поведении системы вблизи положения равновесия.
\subsection{Нормальная форма 2-го порядка}

Сначала выпишем линейное пространство векторных полей $H^2$ у которых каждая координата это однородный многочлен степени 2. Базис будет иметь следующий вид:
\begin{center}
$$
\begin{pmatrix}
x^2 \\
0
\end{pmatrix},\,\,
\begin{pmatrix}
xy \\
0
\end{pmatrix},\,\,
\begin{pmatrix}
y^2 \\
0
\end{pmatrix},\,\,
\begin{pmatrix}
0 \\
x^2
\end{pmatrix},\,\,
\begin{pmatrix}
0 \\
xy
\end{pmatrix}, \,\,
\begin{pmatrix}
0 \\
y^2
\end{pmatrix}.
$$
\end{center}
%
Есть линейный оператор $L_A$, который порождается линейным векторным полем  $A$, который имеет вид $L_A(X):H^2 \longmapsto H^2$ и переводит векторное поле $X$ в векторное поле $[A, \,X]$ и является линейным приближением исходной системы. Иными словами $L_A(X) = ad_A(X) = [A, \,X]$. В силу того, что векторное поле $A$ линейное, для любого полиномиального векторного поля $X$, то векторное поле $ad_A$ полиномиальное. 
Базис состоит из 6 векторов. Это значит, что любой элемент пространства можно описать вектором коэффициентов перед базисными векторами. Теперь подействуем оператором $L_A$ на базисные вектора пространсва $H^2$ и запишем этот результат в матрицу. Эта матрица называется матрицей линейного оператора  $ad_A$. В каждом столбце находятся коэффициенты базисных векторов. 
\begin{center}
$$
\left(\begin{array}{cccccc} 
1 & 1 & 0 & 1 & 0 & 0\\ 
-2 & -1 & 2 & 0 & 1 & 0\\ 
0 & -1 & -3 & 0 & 0 & 1\\ 
-1 & 0 & 0 & 3 & 1 & 0\\ 
0 & -1 & 0 & -2 & 1 & 2\\ 
0 & 0 & -1 & 0 & -1 & -1 
\end{array}\right).
$$
\end{center}
Дальше будем искать образ линейного оператора. Образ $L_A:F^2 = Im(L_a) \subset H^2$. Для этого с помощью MATLAB функции $rref$ приведем к ступенчатому виду матрицу ($L_A \mid E_{6}$), где $E_{6}$ --- единичная матрица размера 6. Получаем следующее:
$$
\left(\begin{array}{ccccccccccccc}
1 & 0 & 0 & 0 & 2 & 3& \mid& 0 & 0 & \displaystyle{\frac{3}{2}} & -1 & -\displaystyle{\frac{3}{2}} & \displaystyle{-\frac{9}{2}}\\
0 & 1 & 0 & 0 & -3 & -4 &\mid& 0 & 0 & -1 & 0 & 0 & 3\\
0 & 0 & 1 & 0 & 1 & 1 &\mid& 0 & 0 & 0 & 0 & 0 & -1\\
0 & 0 & 0 & 1 & 1 & 1 &\mid& 0 & 0 & \displaystyle{\frac{1}{2}} & 0 & -\displaystyle{\frac{1}{2}} & \displaystyle{-\frac{3}{2}}\\
0 & 0 & 0 & 0 & 0 & 0 &\mid& 1 & 0 & -1 & 1 & 2 & 3\\
0 & 0 & 0 & 0 & 0 & 0 &\mid& 0 & 1 & 2 & -2 & -3 & -4 
\end{array}\right)
$$

По этой матрице видно, что ЛНЗ являются только первые 4 столбца, это значит, что образ линейного оператора $L_A : F^2 = Span \{l_1, l_2, l_3, l_4\}$, где $l_i$ это $i$-ый столбец матрицы $L_A$.\\
Всё пространство $H^2$ есть прямая сумма $F^2$ и его прямого дополнения $G^2$, т.е. $H^2 = F^2 \oplus G^2$. Мы должны найти такие вектора, которые будут линейно независимы с векторами в $F^2$. По присоединенной матрице видно, что такими векторами могут быть 7-ой и 8-ой столбец или 1-ый и 2-ой столбец матрицы $E_6$. Получается, что $G_2 = Span\{e_1, e_2\}$, где $e_i$ это $i$-ый столбец матрицы $E_6$. В итоге получаем матрицу перехода:
$$
\left(\begin{array}{cccccc}
1 & 1 & 0 & 1 & 1 & 0\\
-2 & -1 & 2 & 0 & 0 & 1\\
0 & -1 & -3 & 0 & 0 & 0\\
-1 & 0 & 0 & 3 & 0 & 0\\
0 & -1 & 0 & -2 & 0 & 0\\
0 & 0 & -1 & 0 & 0 & 0
\end{array}\right).
$$

Дальше разложим исходную систему в ряд Тейлора до 3го порядка малости $y = A + f_2$, где $A$ --- линейная часть разложения. Найдем $f_2$. Выпишем коэффициенты вектора $f_2$ в старом базисе, домножим его на обратную
матрицу перехода, то есть переведем его в новый базис, тем самым получаем вектор $g_2$. Слагаемые из $F^2$ не влияют на локальное поведение системы, их не учитываем. Зануляем первые 4 координаты, отвечающие $F^2$ и переводим вектор $g_2$ в старый базис.\\
Получаем следующую нормальную форму 2-го порядка.

\begin{equation*}
 \begin{cases}
\dot{x} = x - y + 4x^2 - 7xy;\\
\dot{y} = x - y.
 \end{cases}
  \eqno(1)
\end{equation*}


\subsection{Фазовый портрет в окрестности положения равновесия} 
Вблизи точки покоя будет строиться фазовый портрет. Фазовый портрет был построен с помощью функции $streamslice$. Для этого была задана двумерная сетка так, чтобы положение равновесия было в центре. Сетка задана с шагом 0.01 в каждом направлении. Далее были посчитаны значения двух массивов в точках сетки путем подставления значений сетки в правые части уравнения системы, т.е. значения векторного поля. Ниже представлены фазовые портрет системы вблизи точки покоя и фазовый портрет нормальной формы 2-го порядка.
\newpage
\begin{figure}[h!]
 \centerline{\includegraphics[scale=0.7]{ZeroZero.png}}
 \vskip2mm
 \caption{Фазовый портрет точки в близи ПР.}\label{fig1}
\end{figure} 

\begin{figure}[h!]
 \centerline{\includegraphics[scale=0.7]{ZeroZeroNormForm.png}}
 \vskip2mm
 \caption{Фазовый портрет нормальной формы 2-го порядка в близи ПР.}\label{fig1}
\end{figure} 


\end{document}
