%%  A report on laboratory work 2.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[12pt,a4paper]{article}

%%  Стандартные языковые команды
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}

%%  Подключение стилевого файла отчета
\usepackage{kprj}

%%   Подключение пакета управления гиперссылками (только для pdftex)
\ifpdftex
   \usepackage[unicode=true]{hyperref}
   \hypersetup{pdfpagemode=UseNone, pdfstartview = FitR 0 0 200 1000}
   \BlackColorLinks
\fi

%%%  Для подключения рисунков (разные форматы при разном компилировании)
\ifpdftex
  \DeclareGraphicsExtensions{.pdf}
\else
  \DeclareGraphicsExtensions{.eps}
\fi


\LabWork                      %   тип документа -- лабораторная работа
\LabWorkNo{5}                 %   номер лабораторной работы
\variant{4}                   %   вариант лабораторной


%%%  Данные для оформления

\author{Д.Д.~Девяткин}                     %   автор
\workyear{2020}                         %   год выполнения работы
\title{Аттракторы}   %  название
\discipline{Качественная теория ОДУ}              %  учебная дисциплина
\group{ФН12-71}                          %   группа
\faculty{Фундаментальные науки}         %   Факультет
\chair{Математическое моделирование}    %   кафедра
\chief{А.Н.~Канатников}                     %   Руководитель работы

\equationnumbering{section}             %   если нумерация формул в пределах раздела (иначе единая нумерация)
%\figurenumbering{section}              %   (аналогично для рисунков)

\begin{document}

%%%   Формирование титульного листа
\maketitle
%  Для формирования содержания
\tableofcontents
	

\section-{Постановка задачи}
Для заданной системы 3-го порядка вычислить показатели Ляпунова, сделать
рисунок.
\section{Исходные данные}

\begin{equation*}
 \begin{cases}
\dot{x} = 2.7y + z;\\
\dot{y} = -x + y^2;\\
\dot{z} = x + y;
\end{cases}
\end{equation*}

\section{Реализация}
% \begin{figure}[h!]
 % \centerline{\includegraphics[scale=0.67]{Phase_all_points.png}}
 % \vskip2mm
%  \caption{Фазовый портрет системы вблизи ПР.}\label{fig1}
% \end{figure} 

\textbf{Притягивающее множество} --- множество $K$, обычно компактное, удовлетворяющее условию: существует такая окрестность $U \supset K$, что любая положительная полутраектория, начинающаяся в точке из $U$, имеет $\omega$-предельное множество, целиком лежащее в К. \textbf{Областью притяжения} называют объединение всех множеств $U$ с указанным свойством. \textbf{Аттрактором} называется притягивающее множество, обладающее следующими свойствами: 1) инвариантность; 2) компактность; 3) неразложимость (у него нет таких подможеств, которые удовлетворяют предыдущим условиям [притягиваемость, инвариантность, компактность]). 

Попробуем найти точку в области притяжения аттрактора. Если построить траекторию из такой точки, то она будет проходить на бесконечно малом расстоянии вблизи аттрактора, поскольку он обладает свойством неразделимости. В качестве точки в области притяжения аттрактора можно попробовать рассмотреть точку, которая удалена от положения равновесия на малую величину $\varepsilon$. Найдем положение равновесия системы: такими точками являются $P_1(0,\, 0,\, 0)$ и $P_2(1,\, -1,\, 2.7)$. В качестве малого расстояния возьмем $\varepsilon = 10^{-3}$. Отступим от положения равновесия $P_1$ (можно и $P_2$ взять) на $\varepsilon$ и проинтегрируем систему на интервале времени от 0 до 1000 с шагом 0.1. 
\begin{figure}[h]
\begin{minipage}[h]{0.49\linewidth}
\center{\includegraphics[width=9cm]{attractor.png}}
\end{minipage}
\hfill
\begin{minipage}[h]{0.49\linewidth}
\center{\includegraphics[width=9cm]{attractor_2.png}}
\end{minipage}
\caption{Визуализация аттрактора при интервале времени от 0 до 1000.}
\label{fig1}
\end{figure}
В итоге получим траекторию, которая является ограниченной (см. рис. 1). Теперь можно предположить, что конечная точка данной траектории с некоторой точностью принадлежит аттрактору.
В аттрактор входит семейство переплетенных траекторий. Такие траектории не могут быть устойчивыми, поскольку замыкание устойчивой траектории само было бы аттрактором, а это противоречит условию неразделимости. Характеристикой устойчивости ограниченных траекторий являются \textbf{показатели Ляпунова}, являющиеся аналогами собственных значений линейного приближения в положении равновесия. Пусть есть система $\dot{x} = f(x)$ и $\gamma(t)$ --- её траектория. Составим систему в отклонениях, полагая $y=x - \gamma(t)$. Получаем систему
\begin{center}
$\dot{y} = f(y + \gamma(t)) - \gamma(t)'$
\end{center} 
Теперь рассмотрим систему линейного приближения 
\begin{center}
$\dot{\eta} = f'(\gamma(t))\eta$
\end{center}
Это линейная система с переменной матрицей. Рассмотрим
траекторию $\gamma(t)$ системы линейного приближения. Если матрица системы не зависит от $t$, решение $\eta(t)$ будет выражаться экспоненциальными функциями, которые в зависимости от коэффициента либо будут экспоненциально стремиться к нулю, либо к бесконечности. Характеристикой такого стремления является величина
$$\lambda(\eta) = \varlimsup_{n \to \infty}\dfrac{ln|\eta(t)|}{t},$$
которая называется \textbf{показателем Ляпунова} кривой $\gamma(t)$. Множество характеристических показателей решений линейной системы называется \textbf{спектром линейной системы}. Показатель Ляпунова может быть бесконечной или конечной величиной. В случае, если все решения системы линейного приближения имеют отрицательные показатели Ляпунова, то решение системы устойчиво по Ляпунову, в ином случае, когда показатели положительные --- решение неустойчиво. По \textit{теореме о спектре}  знаем, что спектр состоит из конечного числа элементов, поэтому можно найти наибольшее значение в спектре и посмотреть его знак. Получается, если наибольшее значение в спектре имеет отрицательный знак, то любое решение системы имеет отрицательный характеристический показатель, что говорит о асимптотической устойчивости нулевого положения равновесия. Наибольшее значение в спектре называют \textbf{старшим показателем Ляпунова}.

Теперь найдем фундаментальную систему решений (ФСР). Рассмотрим матрицу $f'(\gamma(t)) = A(t)$, она переменна и зависит от $t$. В случае, когда матрица $A$ постоянна, фундаментальная матрица имеет вид: $X(t) = exp\{At\}$. Чтобы привести матрицу $A(t)$ к постоянной разбиваем кривую с малым шагом по времени, тогда на промежутке $[t_{n-1}, \,t_{n}]$ матрица будет постоянной. В качестве постоянного значения можно выбрать:
\begin{center}
$A_n = \dfrac{f'(\gamma_{n-1}) + f'(\gamma_{n})}{2}$
\end{center}
Тогда на отрезке $[t_{n-1}, \,t_{n}]$ линейную систему можно интегрировать как систему с постоянной матрицей, т.е.
\begin{center}
$\eta(t_k)$ = exp$\{A_k(t_k - t_{k-1})\}\eta(t_{k-1})$
\end{center}
Можно заметить рекурентность и преобразовать к следующему виду
\begin{center}
$\eta(t_k)$ = exp$\{A_k(t_k - t_{k-1})\}\cdot$ exp$\{A_{k-1}(t_k - t_{k-1})\}\cdot$ exp$\{A_1(t_1 - t_{0})\}\eta(t_{0})$
\end{center}
Так как любое решение является линейной комбинацией решений фундаментальной системы, то среди характеристических показателей решений фундаментальной системы есть старший показатель Ляпунова, так как характеристический показатель любого решения не превышает максимального среди характеристических показателей решений фундаментальной системы
Найдем ФСР, положив, что в качестве начальных условий берем столбцы единичной матрицы $E$. Получаем следующее
\begin{center}
$\Phi(t_k)$ = exp$\{A_k(t_k - t_{k-1})\}\cdot$ exp$\{A_{k-1}(t_k - t_{k-1})\}\cdot$ exp$\{A_1(t_1 - t_{0})\}E$
\end{center}
Далее, вычислив $\Phi_k$, можем для каждого $p$-ого столбца $\Phi_{kp}$ найти:
\begin{center}
$\lambda_{kp} = \dfrac{ln|\Phi_{kp}|}{t_k - t_0}$
\end{center}
Для каждого $p$-ого столбца $k$-ой матрицы $\lambda_{kp}$  есть последовательность характеристических показателей для $p$-го решения. Чтобы вычислить верхний предел этой последовательности, можно воспользоваться формулой
\begin{center}
$\lambda_p = \min\limits_{j} \max\limits_{m}\lambda_{kp}\:\:\:\: j=\overline{1,N-s}, \,m=\overline{j,N}.$
\end{center}
В качестве $s$ возьмем значение $s=[0.01N]$.
Получаем следующие показатели Ляпунова:
\begin{center}
$\lambda_1 = 0.0870, \:\:\: \lambda_2 = 0.0875, \:\:\: \lambda_3 = 0.0876
.$
\end{center}
Старший показател имеет положительный знак, получаем, что положение равновесия неустойчиво. Ниже представлен график последовательности показателей.
\begin{figure}[h]
\begin{minipage}[h]{0.49\linewidth}
\center{\includegraphics[width=9cm]{around_zero.png}}
\end{minipage}
\hfill
\begin{minipage}[h]{0.49\linewidth}
\center{\includegraphics[width=9cm]{all_int.png}}
\end{minipage}
\caption{График последовательности показателей.}
\label{fig1}
\end{figure}
\end{document}
