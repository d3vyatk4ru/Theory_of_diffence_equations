%%  A report on laboratory work 2.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[12pt,a4paper]{article}

%%  Стандартные языковые команды
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}

%%  Подключение стилевого файла отчета
\usepackage{kprj}

%%   Подключение пакета управления гиперссылками (только для pdftex)
\ifpdftex
   \usepackage[unicode=true]{hyperref}
   \hypersetup{pdfpagemode=UseNone, pdfstartview = FitR 0 0 200 1000}
   \BlackColorLinks
\fi

%%%  Для подключения рисунков (разные форматы при разном компилировании)
\ifpdftex
  \DeclareGraphicsExtensions{.pdf}
\else
  \DeclareGraphicsExtensions{.eps}
\fi


\LabWork                      %   тип документа -- лабораторная работа
\LabWorkNo{2}                 %   номер лабораторной работы
\variant{4}                   %   вариант лабораторной


%%%  Данные для оформления

\author{Д.Д.~Девяткин}                     %   автор
\workyear{2020}                         %   год выполнения работы
\title{Нелинейные системы}   %  название
\discipline{Качественная теория ОДУ}              %  учебная дисциплина
\group{ФН12-71}                          %   группа
\faculty{Фундаментальные науки}         %   Факультет
\chair{Математическое моделирование}    %   кафедра
\chief{А.Н.~Канатников}                     %   Руководитель работы

\equationnumbering{section}             %   если нумерация формул в пределах раздела (иначе единая нумерация)
%\figurenumbering{section}              %   (аналогично для рисунков)

\begin{document}

%%%   Формирование титульного листа
\maketitle
%  Для формирования содержания
\tableofcontents
	

\section-{Постановка задачи}
Для заданной системы второго порядка выполнить следующий задания:\\
a) найти все положения равновесия;\\
б) исследовать на устойчивость, для гиперболических точек указать тип;\\
в) для седловых точек найти (численно) устойчивое и неустойчивое многообразия;\\
г) нарисовать фазовый портрет системы в окрестности положений равновесия.


\section{Исходные данные}

\begin{equation*}
 \begin{cases}
\dot{x} = 3x + 3y +xy + y^2;\\
\dot{y} = x + y^2.
 \end{cases}
  \eqno(1)
\end{equation*}

\section{Реализация}

\subsection{Положения равновесия системы}
Для поиска точек покоя необходимо приравнять к $0$ правые части каждого из дифференциальных уравнений системы (1) и произвести решение следующей системы
\begin{equation*}
 \begin{cases}
3x + 3y +xy + y^2 = 0;\\
x + y^2 = 0.
 \end{cases}
\end{equation*}
Используя функцию MATLAB $solve$, получаем следующее решение системы
  \begin{equation*}                %equation* для нумерации
\left[                                         
  \begin{gathered} 
    \left\{ 
      \begin{gathered} 
        x = 0{;} \hfill 
        \\ 
        y = 0{;} \hfill 
        \\ 
      \end{gathered} 
    \right. \hfill 
    \\ 
    \left\{ 
      \begin{gathered} 
        x = -1{;} \hfill 
        \\ 
        y = 1{;} \hfill 
        \\ 
      \end{gathered} 
    \right. \hfill 
    \\ 
     \left\{ 
      \begin{gathered} 
        x = -9{;} \hfill 
        \\ 
        y = -3 {.}\hfill 
        \\ 
      \end{gathered} 
    \right. \hfill
    \\  
  \end{gathered}  
\right.
\end{equation*} 
Данная система имеет 3 точки покоя : $P_1(-9,\,-3){,}\,\,\, P_2(-1,\,1)$\, и \,$ P_3(0,\,0){.}$

\subsection{Тип точки покоя и устойчивость}
Для двумерных систем, в зависимости от их собственных значений, можно выделить несколько типов точек покоя: 
\begin{itemize}
\item  Два действительных собственных значения. \textbf{Узел}. [Случай совпадающих корней: жорданов узел (одна жорданова клетка) и дикритический узел (две жордановы клетки)]. 
\item  Два комплексных корня с ненулевой действительной частью. \textbf{Фокус}. 
\item  Два действительных собственных значения разных знаков. \textbf{Седло}.
\item  Два комплексно-сопряженных чисто мнимых корня. \textbf{Центр}.
\item  Вырожденный случай: нулевое собственное значение.
\end{itemize}
Говорят, что положение равновесия \textbf{гиперболическое}, если в нем линейное приближение не имеет собственных значений на мнимой оси. Согласно ляпуновской теории устойчивости, гиперболическое положение равновесия асимитотически устойчиво тогда и только тогда, когда все собственные числа линейного приближения находятся в левой полуплоскости. 

Для исследования типа точек покоя рассмотрим систему первого приближения, чтобы описть конфигурации вблизи положения равновесия (ПР). Для этого находим Якобиан системы и рассматриваем её в каждой точки покоя. Матрица Якоби имеет вид
$$ J = 
\begin{pmatrix}
 y + 3 &  x + 2y + 3 \\
1 & 2y \\
\end{pmatrix}
$$
Получаем следующее:
\begin{itemize}
\item Точка $P_1$ \\
Собственные значения: $\lambda_1 = -3 + \sqrt{3}i, \,\,\, \lambda_2 = -3 - \sqrt{3}i$. ПР является устойчивым. Так же оно гиперболическое.  Поскольку $Re\lambda_1\neq 0, Re\lambda_2 \neq 0 $, то точка является фокусом.
\item Точка $P_2$ \\
Собственные значения: $\lambda_1 = 3 + \sqrt{5}, \,\,\, \lambda_2 =  3 - \sqrt{5}$. ПР неустойчиво, так как хотя бы одно собственное значение имеет положительный знак. Тип точки покоя узел. ПР гиперболическое.
\item Точка $P_3$ \\
Собственные значения: $\lambda_1 = \dfrac{3}{2} - \dfrac{\sqrt{21}}{2}, \,\,\, \lambda_2 = \dfrac{3}{2} + \dfrac{\sqrt{21}}{2}$. ПР неустойчиво и тип точки покоя --- седло. ПР гиперболическое.

\end{itemize}
\subsection{Устойчивое и неустойчивое многообразия}

Численно был произведен поиск устойчивого и неустойчивого многообразий для седловой точки $P_3$. Собственные значения, соответствующие этой точке --- $\lambda_1 = \dfrac{3}{2} - \dfrac{\sqrt{21}}{2}, \,\,\, \lambda_2 = \dfrac{3}{2} + \dfrac{\sqrt{21}}{2}$. Значению $\lambda_1$ соответствует вектор $v_1 = (\dfrac{3}{2} - \dfrac{\sqrt{21}}{2}, \,\,1)^T$, значению $\lambda_2$ вектор $v_2 = (\dfrac{3}{2} + \dfrac{\sqrt{21}}{2}, \,\,1)^T$. Собственное значение $\lambda_1$ соответствует тому, что многообразие будет устойчиво, а $\lambda_2$, что неустойчиво. Поскольку система двумерна, то есть всего 2 собственных значения и 2 собственных вектора. Это значит, что многообразиями будут кривые. Для поиска многообразий была произведена нормировка собственного вектора и отступ на $\varepsilon$ в оба направления вектора от точки $P_3$, путем умножения номированного вектора на, зараннее заданные, $\varepsilon$ и -$\varepsilon$. Так мы получаем начальную точку интегрирования. Аналогично для второго вектора. Дальше выбираем интервал интегрирования: для отрицательных собственных значений интегрируем в прямом направлении, а для положительных в обратном. Далее для каждого из 4-х случаев произведено численное решение нелинейной системы с помощью функции $ode45$. Это и есть вычисление многообразий. Параметр «время интегрирования» был подобран для каждого направления индивидуально. (чтобы траектория была отрисована на весь фазовый график)

\subsection{Фазовый портрет в окрестности положения равновесия}
Для каждого положения равновесия была найдена система первого приближения. В близи неё будет строиться фазовый портрет. Фазовый портрет был построен с помощью функции $streamslice$. Для этого была задана двумерная сетка так, чтобы положение равновесия было в центре. Далее были посчитаны значения двух массивов в точках сетки путем подставления значений сетки в правые части уравнения системы, т.е. значения векторного поля. Ниже представлены фазовые портреты трёх точек.
\begin{figure}[h!]
  \centerline{\includegraphics[scale=0.7]{P_1.png}}
  \vskip2mm
  \caption{Фазовый портрет точки $P_1$. Фокус.}\label{fig1}
\end{figure} 
\begin{figure}[h!]
  \centerline{\includegraphics[scale=0.7]{P_2.png}}
  \vskip2mm
  \caption{Фазовый портрет точки $P_2$. Узел.}\label{fig4}
\end{figure}
\newpage
\begin{figure}[h!]
  \centerline{\includegraphics[scale=0.7]{P_3.png}}
  \vskip2mm
  \caption{Фазовый портрет точки $P_3$. Седло.}\label{fig4}
\end{figure} 

\end{document}
